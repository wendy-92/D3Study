<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>demo4</title>
    <script src="../js/d3.min.js"></script>
</head>
<body>
<h2>demo4</h2>

<script>
  var width = 300;  //画布的宽度
  var height = 300;   //画布的高度

  var svg = d3.select("body")     //选择文档中的body元素
      .append("svg")          //添加一个svg元素
      .attr("width", width)       //设定宽度
      .attr("height", height);    //设定高度
  //画布周边的空白
  var padding = {left:30, right:30, top:20, bottom:20};

  var dataset = [ 2.5 , 2.1 , 1.7 , 1.3 , 0.9 ];  //数据（表示矩形的宽度）

  var Xlinear = d3.scale.ordinal()
      .domain(d3.range(dataset.length))
      .rangeRoundBands([0, width - padding.left - padding.right]);

  var Ylinear =  d3.scale.linear()
      .domain([0,d3.max(dataset)])
      .range([height - padding.top - padding.bottom, 0]);

  var Xaxis = d3.svg.axis()
      .scale(Xlinear)      //指定比例尺
      .orient("bottom")   //指定刻度的方向
      .ticks(7);          //指定刻度的数量

  var Yaxis = d3.svg.axis()
      .scale(Ylinear)      //指定比例尺
      .orient("left")   //指定刻度的方向
      .ticks(7);

  var rectPadding = 4;

  svg.selectAll("rect")
      .data(dataset)
      .enter()
      .append("rect")
      .attr("transform","translate(" + padding.left + "," + padding.top + ")")
      .attr("x", function(d,i){
        return Xlinear(i) + rectPadding/2;
      } )
      .attr("y",function(d){
        return Ylinear(d);
      })
      .attr("width", Xlinear.rangeBand() - rectPadding )
      .attr("height", function(d){
        return height - padding.top - padding.bottom - Ylinear(d);
      })
      .attr("fill","red")         //初始颜色为红色
      .transition()               //启动过渡
      .duration(1000)
      .delay(500)
      .attr("fill","steelblue");   //终止颜色为铁蓝色

  //添加文字元素
  var texts = svg.selectAll(".MyText")
      .data(dataset)
      .enter()
      .append("text")
      .attr("class","MyText")
      .attr("transform","translate(" + padding.left + "," + padding.top + ")")
      .attr("x", function(d,i){
        return Xlinear(i) + rectPadding/2;
      } )
      .attr("y",function(d){
        return Ylinear(d);
      })
      .attr("dx",function(){
        return (Xlinear.rangeBand() - rectPadding)/2;
      })
      .attr("dy",function(d){
        return 20;
      })
      .text(function(d){
        return d;
      });
  svg.append("g")
      .attr("class","axis")
      .attr("transform","translate(" + padding.left + "," + (height - padding.bottom) + ")")
      .call(Xaxis);
  svg.append("g")
      .attr("class","axis")
      .attr("transform","translate(" + padding.left + "," + padding.top + ")")
      .call(Yaxis);


  /* svg.selectAll("rect")   //选择svg内所有的矩形
   .data(dataset)  //绑定数组
   .enter()        //指定选择集的enter部分
   .append("rect") //添加足够数量的矩形元素

   有数据，而没有足够图形元素的时候，使用此方法可以添加足够的元素。*/
</script>
</body>
</html>